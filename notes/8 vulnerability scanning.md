# 8.2.5 unauthenticated nessus
#### Exercises

_(To be performed on your own Kali and public lab machines - Reporting is required for these exercises)_

1.  Follow the steps above to create your own unauthenticated scan of Gamma.
![[nessus_setup.png]]
![[nessus_ports.png]]

2.  Run the scan with Wireshark open and identify the steps the scanner performed to complete the scan.
Using port 27498 as an example, Nessus first performs a simple handshake
![[wireshark_port_27498.png]]
Discovering a web appication, it then begins to try a number of different vulnerability scans, including trying to navigate to and read /etc/passwd 
![[http_passwd_attempt.png]]
the tool even tries path traversal, succeeding in navigating to C:/Windows/win.ini
![[http_directory_traversal.png]]

3.  Review the results of the scan.
with the previously mentioned steps in mind, we can see that nessus used arbitrary file access to read the contents of a file
![[directory_traversal.png]]

# 8.2.7 authenticated nessus
## Practice - Authenticated Scanning With Nessus

_(To be performed on your own Kali and Debian lab client machines - Reporting is required for these exercises)_

1.  Follow the steps above to create your own authenticated scan of your Debian client.


2.  Review the results of the scan.
The authenticated scan revealed an unsupported version of debian running with over 400 vulnerabilities, the bulk of which were rated "High" or above. 
![[authenticated_scan.png]]
![[nessus_OS_detect.png]]
![[nessus_OS_detect2.png]]

# 8.2.9 nessus individual plugins
## Practice - Scanning with Individual Nessus Plugins

_(To be performed on your own Kali and public lab machines - Reporting is required for these exercises)_

1.  Follow the steps above to create your own individual scan of Beta.


2.  Run Wireshark or tcpdump during the individual scan. What other ports does Nessus scan? Why do you think Nessus scans other ports?
Nessus scans numerous other ports in addition to the port specified. Some examples seen in the screenshot below would be 21, 80, 443, and more.
![[nessus_wireshark_ports.png]]

Nessus, and most other vulnerability scanners, run a number of other services and plugins behind the scenes to gather more information on the target, regardless of what is specified. There is no reasonable way to disable this when running Nessus.
3.  Review the results of the scan.
For the specific host an RPC scan was ran with a critical vulnerabilities found.
![[nessus_nfs.png]]


# 8.3.1 vulnerability scanning with nmap
## Practice - Vulnerability Scanning with Nmap

_(To be performed on your own Kali and public lab machines - Reporting is required for these exercises)_

1.  Find an NSE script similar to the NFS Exported Share Information Disclosure that was executed in the "Scanning with Individual Nessus Plugins" section. Once found, run the script against Beta in the PWK labs.

Running an nmap scan with the script "nfs-showmount.nse" will yeild similar results to the nessus plugin "NFS Exported Share Information Disclosure" as both will check for mountable shares.
![[nmap_nfs_enum.png]]
